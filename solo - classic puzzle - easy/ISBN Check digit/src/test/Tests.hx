package test;

import Main;
import Std.parseInt;

using buddy.Should;
using StringTools;
using Lambda;

@:access(Main)
class Tests extends buddy.BuddySuite {
	
	public function new() {
		
		describe( "Test process", {
			
			it( "Example", { Main.process( example ).should.be( parseResult( exampleResult )); });
			it( "Short", { Main.process( short ).should.be( parseResult( shortResult )); });
			it( "Longer", { Main.process( longer ).should.be( parseResult( longerResult )); });
			it( "Much longer", { Main.process( muchLonger ).should.be( parseResult( muchLongerResult )); });
			
		});
	}

	static function parseInput( input:String ) {
		final lines = input.replace( "\t", "" ).replace( "\r", "" ).split( "\n" );
		return lines.slice( 1 );
	}

	static function parseResult( input:String ) {
		return input.replace( "\t", "" ).replace( "\r", "" );
	}
	
	final example = parseInput(
		"6
		0306406152
		013603599X
		1145185215X
		9780306406157
		9780306406154
		978043551907X"
	);

	final exampleResult = parseResult(
		"3 invalid:
		1145185215X
		9780306406154
		978043551907X" );
	
	final short = parseInput(
		"10
		0470371722
		9781119247792
		9780470124512
		11190495550
		1118105354
		9781118737637
		0387372350
		154875155X
		9781548751555
		978193981677"
	);

	final shortResult = parseResult(
		"4 invalid:
		9781119247792
		11190495550
		154875155X
		978193981677" );
	
	final longer = parseInput(
		"21
		0471697037
		1171711743
		1146386265
		9781531807382
		0671039414
		0553282964
		0743412524
		Im_garbage
		0553270502
		9781784399092
		0553493825
		9781511343572
		0553156284
		0553570099
		9780606393188
		97804X8458533
		9780745669779
		0976315262
		1498773192
		9780408478999
		9780691154305"
	);

	final longerResult = parseResult(
		"6 invalid:
		0471697037
		0671039414
		Im_garbage
		0553270502
		97804X8458533
		9780408478999" );
	
	final muchLonger = parseInput(
		"309
		0880221576
		1145185215
		9781843547587
		9781848873414
		9780470105542
		0471697036
		111842297X
		978111843111X
		0671039423
		0553493515
		0448484277
		9780134177304
		9781119056454
		0471379807
		047124371X
		9780134177296
		013708160X
		0471697044
		111843112X
		9783540684695
		039309202X
		9781592291236
		3794515471
		0980190207
		9781620322321
		0722532121
		9780198790563
		9783848419616
		0077660811
		0736911537
		1592290256
		9780538797825
		1780781004
		3764374829
		0139182276
		0195132912
		0314262687
		9783330328358
		9780723455585
		9780199658572
		9780133661750
		3510490738
		9780702068591
		0918860172
		1938168232
		0842309969
		0801401345
		3211249648
		143022889X
		0953169650
		9780133661712
		9780133661750
		9780133661743
		9780133661736
		9780230028234
		9780230028319
		9780230028352
		0071244743
		9780071244749
		8120336097
		9780321945525
		0321614003
		9780807753132
		0176269940
		9780176357139
		0435519093
		9780435519094
		9780435519070
		9781471882524
		9781471882982
		0195695070
		0198080026
		1259027120
		1259027074
		9781111428747
		1305115309
		0534492770
		019500714X
		97801950071455
		0199461562
		0199461589
		0199461554
		0199461651
		0199461678
		0198070500
		0198070527
		0198070543
		9781292232539
		019809972X
		0198099703
		0198099711
		0195695100
		8120339673
		9781107667815
		9781107665996
		0195669533
		0195665139
		0195669576
		81203465803
		8120334647
		8120342488
		9780486469249
		366249437X
		1408507730
		9781292210889
		9780495391326
		8131533026
		0495826162
		0534096301
		048667164X
		9780134423319
		0134423313
		9780321825728
		0321646967
		0431068941
		0431079358
		9781441960528
		0038796981
		9780465096107
		9781781254332
		0195669584
		0195669606
		9781446285947
		0176201068
		0198082290
		1408518988
		1408519003
		1408518996
		0335012116
		0335010148
		9781447987864
		9780021379583
		9781782944072
		9780133935592
		9780321987297
		9780198390114
		0486409163
		8120342356
		1556080026
		0486240738
		9781471852862
		9781471852978
		9781107682269
		9780143128298
		9380108206
		9781449604424
		9781483381602
		9332571058
		0130177628
		032182573X
		0132909537
		9780134046952
		3540416625
		1852332360
		9780470525487
		0471543977
		1408223201
		9332517339
		0078298067
		1859962920
		007141049X
		9781402788291
		9781316644287
		812035088X
		0201445603
		0387960171
		0387902740
		9781630940423
		0821850032
		9231019058
		9780821536056
		0435028324
		0435019813
		1439049483
		0387856498
		0387856471
		9789813146341
		9780321915337
		0536260273
		0321923219
		0582207258
		9781506209227
		0442043007
		049501866X
		0387905642
		9780273719779
		9780070973329
		9781471884429
		9780435181444
		9780486789996
		0471219215
		9780786477067
		9781107043169
		9781629147062
		0486450104
		9781316600207
		0387207090
		9788469821237
		0131221302
		0486649407
		0130676993
		0130087475
		9781292096315
		0534011365
		9781305635159
		9780957389465
		0866511873
		9780521868426
		9789814596091
		9781408523797
		9781474286459
		9781471860218
		0273086464
		9781292146218
		087548154X
		0669093696
		0602279763
		0124356206
		9783319194219
		9780691175997
		0387902775
		9781526410962
		0030783380
		9781138673700
		9781305071704
		9781471889912
		9780691175836
		0495213810
		0003225100
		0582279089
		9780321836991
		9783319421193
		1858385164
		9789814602907
		0387968849
		9780192737069
		0126924023
		0805388893
		9780076110001
		0195695216
		0849385237
		I_am_error
		052146966X
		0125267401
		8120345401
		9781598033106
		9780321931900
		0387979263
		0393957330
		8130916002
		0387946128
		0387207333
		0387909923
		0140511199
		0821804510
		8179924076
		1730125808
		0139078746
		9783319012308
		354094057X
		9781118457443
		9781107698994
		3540971734
		9332575150
		8126511338
		9781493937783
		9780134556406
		0205408443
		019514743X
		9781292074610
		0415508207
		0387955852
		0486637603
		0700514082
		3764330333
		1846841046
		1461490952
		9781461490951
		0765260565
		0765260573
		9781316509234
		9781493932221
		0387900926
		9380257031
		0387985093
		9781441931313
		1850001979
		9780486492377
		0201263009
		9788184570267
		8180521702
		9781858532172
		8185931844
		0192893068
		019807056X
		9780495559993
		9332577552
		9781846840075
		9780134468372
		0131873636
		9780325052878
		8131732185
		140205033X
		9048172608
		0076213854
		9780076213856
		0387989498
		9784431549345
		9789814513432"
	);

	final muchLongerResult = parseResult(
		"12 invalid:
		0880221576
		978111843111X
		0471379807
		9780134177296
		1780781004
		0801401345
		9780230028352
		97801950071455
		81203465803
		0038796981
		I_am_error
		9781846840075" );
	

}


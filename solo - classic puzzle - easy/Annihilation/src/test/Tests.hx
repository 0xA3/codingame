package test;

import Std.parseInt;

using buddy.Should;
using StringTools;

@:access(Main)
class Tests extends buddy.BuddySuite {
	
	public function new() {
		
		describe( "Test process", {
			it( "Test Down", {
				final ip = testDown;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 1 );
			});
			it( "Test 1", {
				final ip = test1;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 1 );
			});
			it( "Test 2", {
				final ip = test2;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 29 );
			});
			it( "Test 3", {
				final ip = test3;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 42 );
			});
			it( "Test 4", {
				final ip = test4;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 237 );
			});
			it( "Test 5", {
				final ip = test5;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 1084 );
			});
			it( "Test 6", {
				final ip = test6;
				Main.process( ip.grid, ip.w, ip.h ).should.be( 2215 );
			});
		});

	}

	static function parseInput( input:String ) {
		final lines = input.replace( "\t", "" ).replace( "\r", "" ).split( "\n" );
		final inputs = lines[0].split(' ');
		final h = parseInt( inputs[0] );
		final w = parseInt( inputs[1] );
		final grid = [for( i in 0...h ) lines[i + 1].split( '' )];
			
		return { w: w, h: h, grid: grid }
	}

	static final testDown = parseInput(
	"5 5
	..v..
	.....
	.....
	.....
	....." );

	static final test1 = parseInput(
	"5 5
	.....
	..v..
	.>.<.
	..^..
	....." );

	static final test2 = parseInput(
	"5 6
	>.....
	......
	......
	......
	.....^" );

	static final test3 = parseInput(
	"9 8
	.......>
	........
	<.>..<.^
	><.....^
	.^..v^..
	...v.>..
	.....^<.
	...>....
	<.^^...v" );

	static final test4 = parseInput(
	"16 17
	..^.^>....v><.<..
	^..v.<v...vv.>.^.
	vv..>.v.<...v<<.^
	>.>^.<^..<..vvv.^
	>..^vv...<.<v..<.
	..>.^.<.<.>.>..>v
	..><.<>^v<v>^.<.>
	.<.<>......>v^.>.
	..^>.<>^..<..<>>.
	.>.^v<..>.^v<.>>v
	>>^v.^v^.<>.v>...
	>^^v>>><.^v>.....
	.^..>><>>^v<.v..^
	.>v....<>>>>^.<v<
	>v^.^v.>..^^^^<<.
	.v.v<..><.v^.^..." );

	static final test5 = parseInput(
	"41 33
	.><<><<<>v>>><<.v^>v.v>.v<.^^><v^
	><.^v>^><<v>.v<><.vv>>.>v<.>v<v^^
	>.<v.^v.v.^..v.v.<<.v^>^^v^<^^<<.
	..^v...<vvv.<<v^v<vvv<vv.^^>>^.>^
	<<^^.<<vv>>v>>..v<>^<^v^<<..^<>^^
	>.<vv^<<^^<^.v><<<vv>.v^.^>>v^<v>
	<<<..^^^<<^.vvv^..><>>^^v<^^.^^>.
	>v>>^>^^^^<^<>>^<<^<v<.>>^<<.^>^.
	<>.^^.v^<.<^<vv.<.^>>>>><.<v<<^.>
	...^^.^.v.v.^..<^^>.<.v^<>..<<v>^
	<>vv>^.>vv.v^v^>.<v.vv<v.<<^^.^<>
	v^v>^><.>^<^^.<<^>.<.v><^<<.>><.<
	.v^>>v^<v.>v>.<<<>.<.^<v>v>v>vvv.
	<..vv<v.<><<.>>>.>>>^v.^.^<v>^^<v
	v^vv<.>v.<<.>>.v^^.^v^v.>v.<.vv><
	><^^<vv<vv<vv>^.<>^^v.^^.<vv>^^^<
	..^>.^.....<>^>v>^vvv.^>^..v.v>>.
	^^><v><^.>.^>v.^>vv.>^>.v>v.<<><<
	<.v^^<.>>^v<<<..>^v^.vv<v<v^^^>v>
	<^^.>><<>.v<.^^^v.^.v.^<^v<<><>^^
	^>><v>v.><>^vv<v.<.v^<>^.><<>^.>.
	.>^><.><^>><>>>vv^^^<<v><>><<v>.v
	vv.>v<.v<^<..v.vv<><<.^v><>vvv.<^
	>v^v<>vvv<.^^>v.<^><.>..>^.>><^^v
	v>^^vv><><>.vv^<.>..><.<<v<<>.v.^
	<v><.v..^<><v^^.<^<<<.>v^>><<.^^^
	.>^>>>^^^^^...>>>^..>.>>>.vv<..<>
	.v>^>.^^.^^.^>>>vvvv>v^v>>^<>^<^v
	.>>>v<^v^^<^<.><..^<<v.v<vv^v><.^
	<.<<^.<.^^vv^^.<<v^<^.v<v>..v.<..
	v.<>^.^>>v.v<vv^><<<v><<.<^<^^v.v
	><<<>vv>^^^<^vv.<<^.>^<.><>^v>><v
	.^v^v><>^.><<>^^^..v.v^^.v>v.^^.<
	<.^>..>v>.<>>^<.v...v..<<.>^>^.^v
	v.vv<v^v.>^<<v.>v>^>vv>><.vv<<><v
	>><v^<..>^>>.^<v>>v<.>>..><>.<v.<
	^>^^^.>^><.<vv>.v<<v<^.<vv..^.^><
	>^>vv>.v<<v>^^^><><v^>^<<<^^^>>^v
	.<>^<v.>.>v>^><>v..<^.<>vvv<<<^v.
	v.><^^<^<.v>^<<.>.<<<^>v.^^.^v.>.
	.vv>^<.v>>.v.^<vvv<><>v^^>vv>>^.<" );
	
	static final test6 = parseInput(
	"50 49
	.^<.v^<>..<^v.^<^>..<vv^.<<v.^<vv>>>vvvv<^^v<^>vv
	>^v^>vv><^vv..><v<<^.v<<.^v>>>.v.v.>>.>>>^v.vv<>^
	.^.<^>^v.^v^^.v<v^.<.<^v<.v.^.><^v<^>v..>v>v.<<<>
	^^.vv^>>.>.<vvvvv>>.>>v>^.v^<^<.>v<>>.<^<>>..>^<.
	^><v.v><>><^^<>v><v<<>^v^v.^<^v<>v<.>v^vvv^>.><..
	>.<><.<v^.v.v^<>>.>.^.>^v<.<..>.>><v..v>>^>>^>.>.
	^^.<<v<v<^^<v^.v^^^v^>>vvv<.^<>>..v><v^.^^v^v<><>
	^.v<vv.<.<>^v.<.<<<>^><^>><^.><>v>.<^>^^<...v^><<
	<^.<><<<.<^v<v.vv<<vvv^v<^>.^^v><..vv><<<v>^>>>.v
	.>v<>v>vv.<^v>^><v^^<^v>.vv>.>><v^<<v>^>>...^.<.v
	<v><.<v<.v^v^>v^.v>v<..<v<><>>>.>>^^.><^vv>v<>>vv
	.><<v<vv^<v.>..<<v<v^<..v>v^<^<<.>v.<^<^<<.v^^.v^
	.>^>v>>>..<v.>>>.>><vv.<>.^v.v<..<>vv^>^.^^>v^.<<
	^^..<>^v>v<.vv^^^vv><>v^>>.^^>v.>v<<^^v>.^^.>>vv^
	v<...^^.>.<vv>vvv<>>><..>.<^v>>>.>^v>.v<.<><^v>^>
	..<.<^^v....<^^^^v<>v^>.<<v<.<><<>^<v<v<vv>><v^v^
	..>^v.>^><^>v>>vv<^>^.>^.^<v<^^v^.v<v^.<vv><<.^v.
	<.>>><<<v^.v^vvv>..v<<.^>.^^<<v<^..^..<>^v^<.^.<.
	<^..vv<><^v<.<vv<<vv.v<>v>.<.<><^^^><.^>.>..<..>>
	v^^^...>^>.<^^v>^v.vv^^.><v>>.^>>>^>>.<vv^<^^^v.<
	>>v^v<<<<><v>^^<^.vv.^>v^vv^<v<<v>.^>>..^..<^>v..
	^>^^<vv>.^^.v.<^><^>>>v<.^.^>>.v^.^.>v^.v<>>>.^.>
	...v>.v<>^^<<<.><>^>^<v<v..<vv^^.<<>v<.<><>>.>>^>
	<^v<..<^<<>^..v.<<^^>v..<<^^<v..^^>.v><<v^>.v.<<>
	^^>^.^><.v<>^<>^.<vv>.^>v>.<^<>v>^.v>v>.^^>v.v>^^
	<.<>v^..><v^v<^^<.>><v^^.>vvv>^^v><<^.v.^^<vv<^<v
	><<^<.<.>v^.<>.^>>.>^^>>.v>.vv<>^v>>^<..v.<v<v^<>
	v>v.vvv^<v.vv^><^.^^^>v^vv.>^.^v.^<>.<..^v^.<^>.>
	v^<v...^<^^<>>^<v^^<>v..<v^>.^<v<.v^<v.<>^<.^>>^^
	^><>.^^v<.<^>v^>.vv<.>^vv<<<^..v>v<^.^>><vv^v>.^^
	>^<v<>.<v<><.<.^.v<>vvv.<<>><>vv^>v^><^<.^v>vvv>^
	<v<...v.>v^.^>.v><^..<v^^><>..>..<v><.>>>^.v>.^<>
	>.<.<.<>><v<^.>^.^>.v<^.^><<.v<<v<^>^>.^>^.^vv>..
	v<<.>^^<>vvvv>v.>.>.v>^..<.v>.>>><^.v..>>v^><vv><
	^<^.>^.v<v<.>^><^<v.v.><<>.v<<v.^>v<v>><<^v>vv<>v
	>.><>>^v.<><.v<^>>>v>^^^v.><<^^>...<<<<^>v>>>^<>>
	.>><><^.^^<<.v^<<vv.>^<.vv<>>.><.><^^v^.>>>>vv>.<
	v<^<.v.<>^..<>...<<>v><vv><.<^>.<v>>^<^.<v<v^<.>^
	^^v<<^<vv>.^<^>v^.^^><^<.v^<^..<..v<<^v..^>.vv><^
	vv....^<.^.<><.v<><>^<<^vv>v<><>>.v<^^v<..^<^<<<^
	^v<^.^.><><vv<.>^>^<v^<>^.<<.>v.<vv><>v>v><.^<<.<
	..<^^>v<.<<..^vv<.><<v>^v>^<...^^.<^.^<>.^<><^>.v
	^v><<^.^>.<>v^^>.<v<.v.^v<<^<>^.>><^v^^v><v.v.^^.
	.<v<><<<^v<.<v..v^<^<<v<..>>v.<<v^^<v<^>>.^>vv..<
	^.v>.v^v..^>v>vv>^<v.>>.<v^^>><^^v>v^.<<^><^v<^.^
	.^.>.>>.<>>^>^v<<.v>>>v>v<..^v^>v<<v.<v>>>>^<..>v
	<<>.v^v>>>^>v^><^^v.^^v>^.>v<<<<.<<<.^.>^>.^.vv.<
	^^^>^.v.^>^.v^^^>^.v>^>^>.<.>>.vv><<>v<v.>>>..>>v
	.^>^.>.<^.v^vv>..^>^.>^^><.><^^.v^^<...>>>^>^..^>
	>v<vvv<^^v^^v<<.>..>.>v>>>v^.<>><vv>><.v^v^..^<<." );
}

